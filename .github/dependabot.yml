version: 2

# Optimiert: Wöchentliche gebündelte Updates + getrennte Major-Bündel für leichteres Review.
updates:
  # Backend (Gradle)
  - package-ecosystem: "gradle"
    directory: "/Backend"
    schedule:
      interval: "weekly"
      day: "sunday"
      time: "05:00"
      timezone: "Europe/Berlin"
    open-pull-requests-limit: 8
    rebase-strategy: auto
    commit-message:
      prefix: "chore(deps)"
      prefix-development: "chore(deps-dev)"
      include: "scope"
    labels:
      - "dependencies"
      - "backend"
    groups:
      gradle-patch-minor:
        applies-to: version-updates
        update-types:
          - patch
          - minor
      spring-major:
        applies-to: version-updates
        patterns:
          - org.springframework.boot:*
          - org.springframework.cloud:*
        update-types:
          - major
      test-libs:
        applies-to: version-updates
        patterns:
          - org.junit.jupiter:*
          - org.mockito:*
          - org.assertj:*
        update-types:
          - patch
          - minor

  # Frontend (pnpm via npm)
  - package-ecosystem: "npm"
    directory: "/Frontend"
    schedule:
      interval: "weekly"
      day: "sunday"
      time: "05:30"
      timezone: "Europe/Berlin"
    open-pull-requests-limit: 8
    rebase-strategy: auto
    commit-message:
      prefix: "chore(deps)"
      prefix-development: "chore(deps-dev)"
      include: "scope"
    labels:
      - "dependencies"
      - "frontend"
    groups:
      angular-framework:
        applies-to: version-updates
        patterns:
          - "@angular*"
          - rxjs
          - zone.js
        update-types:
          - patch
          - minor
      angular-major:
        applies-to: version-updates
        patterns:
          - "@angular*"
          - rxjs
        update-types:
          - major
      types-packages:
        applies-to: version-updates
        patterns:
          - "@types/*"
        update-types:
          - patch
          - minor
      lint-build:
        applies-to: version-updates
        patterns:
          - eslint*
          - "@typescript-eslint*"
          - typescript
        update-types:
          - patch
          - minor

  # GitHub Actions
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "sunday"
      time: "05:15"
      timezone: "Europe/Berlin"
    open-pull-requests-limit: 5
    rebase-strategy: auto
    commit-message:
      prefix: "ci(deps)"
      include: "scope"
    labels:
      - "dependencies"
      - "github_actions"

  # Docker Backend
  - package-ecosystem: "docker"
    directory: "/Backend"
    schedule:
      interval: "weekly"
      day: "sunday"
      time: "05:45"
      timezone: "Europe/Berlin"
    open-pull-requests-limit: 5
    commit-message:
      prefix: "chore(deps)"
      include: "scope"
    labels:
      - "dependencies"
      - "backend"
      - "docker"

  # Docker Frontend
  - package-ecosystem: "docker"
    directory: "/Frontend"
    schedule:
      interval: "weekly"
      day: "sunday"
      time: "05:50"
      timezone: "Europe/Berlin"
    open-pull-requests-limit: 5
    commit-message:
      prefix: "chore(deps)"
      include: "scope"
    labels:
      - "dependencies"
      - "frontend"
      - "docker"

# Hinweise:
# - Security Alerts werden weiterhin sofort (separate Mechanik) erstellt.
# - Major Updates separat => klarer Review / Changelog Prüfung.
# - Patch/Minor zusammen reduziert CI-Läufe & Merge-Konflikte.
# - Zeitslots früh (Europe/Berlin) minimieren Beeinträchtigung.
# Optional: reviewers:, assignees:, ignore:, allow: für noch feinere Steuerung.
